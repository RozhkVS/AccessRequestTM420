function fixIERangeObject(t,e){if(e=e||window,!t)return null;if(!t.startContainer&&e.document.selection){var r=function(t,e){for(var r=null,n=-1,o=t.firstChild;o;o=o.nextSibling)if(3==o.nodeType){var i=o.nodeValue;if(0!=e.indexOf(i)||e==i){r=o,n=e.length-1;break}e=e.substring(i.length)}return{node:r,offset:n}},n=t.duplicate(),o=t.duplicate(),i=t.duplicate(),a=t.duplicate();n.collapse(!0),n.moveEnd("character",1),o.collapse(!1),o.moveStart("character",-1);var s=n.parentElement(),u=o.parentElement();if(s instanceof HTMLInputElement||u instanceof HTMLInputElement)return null;i.moveToElementText(s),i.setEndPoint("EndToEnd",n),a.moveToElementText(u),a.setEndPoint("EndToEnd",o);var l=i.text,f=a.text,c=r(s,l),p=r(u,f);t.startContainer=c.node,t.startOffset=c.offset,t.endContainer=p.node,t.endOffset=p.offset+1}return t}function getRangeObject(t){if((t=t||window).getSelection)try{return t.getSelection().getRangeAt(0)}catch(t){}else if(t.document.selection){return fixIERangeObject(t.document.selection.createRange(),t)}return null}function isEmpty(t){return null==t||""==String(t)||void 0===t||"number"==typeof t&&isNaN(t)}function dateDiff(t,e,r){if(!isInstance(t,Date)||!isInstance(e,Date))return null;if(null==r&&(r=JST_FIELD_DAY),r<0||r>JST_FIELD_YEAR)return null;if(r<=JST_FIELD_DAY){var n=1;switch(r){case JST_FIELD_SECOND:n=MILLIS_IN_SECOND;break;case JST_FIELD_MINUTE:n=MILLIS_IN_MINUTE;break;case JST_FIELD_HOUR:n=MILLIS_IN_HOUR;break;case JST_FIELD_DAY:n=MILLIS_IN_DAY}return Math.round((e.getTime()-t.getTime())/n)}var o=e.getFullYear()-t.getFullYear();if(r==JST_FIELD_YEAR)return o;if(r==JST_FIELD_MONTH){var i=t.getMonth(),a=e.getMonth();return o<0?i+=12*Math.abs(o):o>0&&(a+=12*o),a-i}return null}function isInstance(t,e){if(null==t||null==e)return!1;if(t instanceof e)return!0;if(e==String&&"string"==typeof t)return!0;if(e==Number&&"number"==typeof t)return!0;if(e==Array&&"array"==typeof t)return!0;if(e==Function&&"function"==typeof t)return!0;for(var r=t.base;null!=r;){if(r==e)return!0;r=r.base}return!1}!function(){if("function"==typeof window.CustomEvent)return!1;window.CustomEvent=function(t,e){e=e||{bubbles:!1,cancelable:!1,detail:null};var r=document.createEvent("CustomEvent");return r.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),r}}(),function(t){t.matches=t.matches||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector,t.closest=t.closest||function(t){return this?this.matches(t)?this:this.parentElement?this.parentElement.closest(t):null:null}}(Element.prototype),String.prototype.escapeJSON=function(){for(var t="",e=0;e<this.length;e++){var r=this[e];switch(r){case"\\":r="\\\\";break;case String.fromCharCode(34):case String.fromCharCode(34):r=String.fromCharCode(92,34);break;case"&":r="\\&";break;case"\t":r="\\t";break;case"\n":r="\\n";break;case"\r":r="\\r";break;case"\b":r="\\b";break;case"\f":r="\\f";break;case"\v":r="\\v"}t+=r}return t},String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return this.substr(!e||e<0?0:+e,t.length)===t}),String.prototype.endsWith||(String.prototype.endsWith=function(t,e){return(void 0===e||e>this.length)&&(e=this.length),this.substring(e-t.length,e)===t}),String.prototype.includes||(String.prototype.includes=function(t,e){"use strict";return"number"!=typeof e&&(e=0),!(e+t.length>this.length)&&-1!==this.indexOf(t,e)}),Array.prototype.findLastIndex||(Array.prototype.findLastIndex=function(t,e){for(var r=this.length-1;r>=0;r--)if(t.call(e,this[r],r,this))return r;return-1}),String.prototype.substring||(String.prototype.substring=function(t,e){void 0===e&&(e=this.length),e<0&&(e=this.length+e),t<0&&(t=this.length+t);var r=(e=Math.min(this.length,e))-t;return r<0&&(r=0),this.slice(t,e)}),Array.prototype.forEach||(Array.prototype.forEach=function(t,e){var r,n;if(null==this)throw new TypeError(" this is null or not defined");var o=Object(this),i=o.length>>>0;if("function"!=typeof t)throw new TypeError(t+" is not a function");for(arguments.length>1&&(r=e),n=0;n<i;){var a;n in o&&(a=o[n],t.call(r,a,n,o)),n++}}),Array.prototype.sort||(Array.prototype.sort=function(t){for(var e=0;e<this.length-1;e++)for(var r=0;r<this.length-e-1;r++)if(t?t(this[r],this[r+1])>0:this[r]>this[r+1]){const t=this[r];this[r]=this[r+1],this[r+1]=t}return this}),Array.prototype.map||(Array.prototype.map=function(t,e){var r,n,o;if(null==this)throw new TypeError(" this is null or not defined");var i=Object(this),a=i.length>>>0;if("function"!=typeof t)throw new TypeError(t+" is not a function");for(arguments.length>1&&(r=e),n=new Array(a),o=0;o<a;){var s,u;o in i&&(s=i[o],u=t.call(r,s,o,i),n[o]=u),o++}return n}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(t,e){for(var r=e=e>=0?e:this.length-1;r>=0;r--)if(this[r]===t)return r;return-1}),Array.prototype.findIndex||(Array.prototype.findIndex=function(t){if(null==this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,r=Object(this),n=r.length>>>0,o=arguments[1],i=0;i<n;i++)if(e=r[i],t.call(o,e,i,r))return i;return-1}),Array.prototype.every||(Array.prototype.every=function(t,e){"use strict";var r,n;if(null==this)throw new TypeError("this is null or not defined");var o=Object(this),i=o.length>>>0;if("function"!=typeof t)throw new TypeError;for(arguments.length>1&&(r=e),n=0;n<i;){var a;if(n in o)if(a=o[n],!t.call(r,a,n,o))return!1;n++}return!0}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),r=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var n=arguments[1],o=0;o<r;){var i=e[o];if(t.call(n,i,o,e))return i;o++}},configurable:!0,writable:!0}),Array.prototype.filter||(Array.prototype.filter=function(t){"use strict";if(null==this)throw new TypeError;var e=Object(this),r=e.length>>>0;if("function"!=typeof t)throw new TypeError;for(var n=[],o=arguments.length>=2?arguments[1]:void 0,i=0;i<r;i++)if(i in e){var a=e[i];t.call(o,a,i,e)&&n.push(a)}return n}),Array.prototype.some||(Array.prototype.some=function(t,e){"use strict";if(null==this)throw new TypeError("Array.prototype.some called on null or undefined");if("function"!=typeof t)throw new TypeError;for(var r=Object(this),n=r.length>>>0,o=0;o<n;o++)if(o in r&&t.call(e,r[o],o,r))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(t){"use strict";if(null==this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof t)throw new TypeError(t+" is not a function");var e,r=Object(this),n=r.length>>>0,o=0;if(arguments.length>=2)e=arguments[1];else{for(;o<n&&!(o in r);)o++;if(o>=n)throw new TypeError("Reduce of empty array with no initial value");e=r[o++]}for(;o<n;o++)o in r&&(e=t(e,r[o],o,r));return e}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),r=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var n=arguments[1],o=0;o<r;){var i=e[o];if(t.call(n,i,o,e))return i;o++}},configurable:!0,writable:!0}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var r=Object(this),n=r.length>>>0;if(0===n)return!1;var o,i,a=0|e,s=Math.max(a>=0?a:n-Math.abs(a),0);for(;s<n;){if((o=r[s])===(i=t)||"number"==typeof o&&"number"==typeof i&&isNaN(o)&&isNaN(i))return!0;s++}return!1}}),Array.prototype.reverse||Object.defineProperty(Array.prototype,"reverse",{value:function(){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),e=t.length>>>0;if(0===e)return!1;for(var r=Array(e);t.length;)r.push(t.pop());return r}}),Array.prototype.difference||Object.defineProperty(Array.prototype,"difference",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),r=e.length>>>0;if(0===r)return e;for(var n=[],o=0;o<r;++o)t.indexOf(e[o])<0&&n.push(e[o]);return n}}),Array.prototype.intersect||Object.defineProperty(Array.prototype,"intersect",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),r=e.length>>>0;if(0===r)return e;for(var n=[],o=0;o<r;++o)t.indexOf(e[o])>=0&&n.push(e[o]);return n}}),function(){var t=function(t){return new RegExp("(^| )"+t+"( |$)")},e=function(t,e,r){for(var n=0;n<t.length;n++)e.call(r,t[n])};function r(t){this.element=t}r.prototype={add:function(){e(arguments,(function(t){this.contains(t)||(this.element.className+=" "+t)}),this)},remove:function(){e(arguments,(function(e){this.element.className=this.element.className.replace(t(e),"")}),this)},toggle:function(t){return this.contains(t)?(this.remove(t),!1):(this.add(t),!0)},contains:function(e){return t(e).test(this.element.className)},replace:function(t,e){this.remove(t),this.add(e)}},"classList"in Element.prototype||Object.defineProperty(Element.prototype,"classList",{get:function(){return new r(this)}}),window.DOMTokenList&&null==DOMTokenList.prototype.replace&&(DOMTokenList.prototype.replace=r.prototype.replace)}();var extend=function(){for(var t in{toString:null})return function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)t[n]=r[n]}return t};var e=["toString","valueOf","constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString"];return function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var o in n)t[o]=n[o];for(var i=0;i<e.length;i++)o=e[i],n.hasOwnProperty(o)&&(t[o]=n[o])}return t}}();function Set(){this.values={},this.n=0,this.add.apply(this,arguments)}Set.prototype.add=function(){for(var t=0;t<arguments.length;t++){var e=arguments[t],r=Set._v2s(e);this.values.hasOwnProperty(r)||(this.values[r]=e,this.n++)}return this},Set.prototype.remove=function(){for(var t=0;t<arguments.length;t++){var e=Set._v2s(arguments[t]);this.values.hasOwnProperty(e)&&(delete this.values[e],this.n--)}return this},Set.prototype.contains=function(t){return this.values.hasOwnProperty(Set._v2s(t))},Set.prototype.size=function(){return this.n},Set.prototype.foreach=function(t,e){for(var r in this.values)this.values.hasOwnProperty(r)&&t.call(e,this.values[r])},Set._v2s=function(t){switch(t){case void 0:return"u";case null:return"n";case!0:return"t";case!1:return"f";default:switch(typeof t){case"number":return"#"+t;case"string":return'"'+t;default:return"@"+function(t){var e="|**objectid**|";t.hasOwnProperty(e)||(t[e]=Set._v2s.next++);return t[e]}(t)}}},Set._v2s.next=100,extend(Set.prototype,{toString:function(){var t="{",e=0;return this.foreach((function(r){t+=(e++>0?", ":"")+r})),t+"}"},toLocaleString:function(){var t="{",e=0;return this.foreach((function(r){e++>0&&(t+=", "),t+=null==r?r:r.toLocaleString()})),t+"}"},toArray:function(){var t=[];return this.foreach((function(e){t.push(e)})),t}}),Set.prototype.toJSON=Set.prototype.toArray;var constant=(ownProp=Object.prototype.hasOwnProperty,allowed={string:1,number:1,boolean:1},prefix=(Math.random()+"_").slice(2),{set:function(t,e){return!this.isDefined(t)&&!!ownProp.call(allowed,typeof e)&&(constants[prefix+t]=e,!0)},isDefined:function(t){return ownProp.call(constants,prefix+t)},get:function(t){return this.isDefined(t)?constants[prefix+t]:null}});function BrowserCheck(){var t={KHTML:/Konqueror|KHTML/.test(navigator.userAgent)&&!/Apple/.test(navigator.userAgent),Safari:/KHTML/.test(navigator.userAgent)&&/Apple/.test(navigator.userAgent),Opera:!!window.opera,MSIE:!(!window.attachEvent||window.opera),Gecko:/Gecko/.test(navigator.userAgent)&&!/Konqueror|KHTML/.test(navigator.userAgent)};navigator.platform.indexOf("Win"),navigator.platform.indexOf("Mac"),navigator.platform.indexOf("Linux");for(key in t)if(t[key]){var e=key;break}e&&"MSIE"==e&&(this.ie=!0),e&&"Safari"==e&&(this.ns=!0),e&&"Safari"==e&&(this.khtml=!0),e&&"Safari"==e&&(this.opera=!0),e&&"Safari"==e&&(this.gecko=!0)}function preload(imgObj,imgSrc){document.images&&(eval(imgObj+" = new Image()"),eval(imgObj+'.src = "'+imgSrc+'"'))}function getStrContentSize(t,e,r){var n,o,i=parseInt(window.getComputedStyle(window.document.body).fontSize),a=document.createElement("div"),s=a.style,u=document.createTextNode(t),l="display:none;left:-1000px;width:auto;height:auto;";return l+="font-family:"+window.getComputedStyle(window.document.body).fontFamily+";",l+="font-size:"+i+"px;",e&&(l+="font-style:"+(e?"italic":"normal")+";"),r&&(l+="font-weight:"+(r?"bold":"normal")+";"),l+="line-height:"+(i+3)+"px;",l+="overflow-x:hidden;",l+="overflow-y:hidden;",a.style.cssText=l,a.appendChild(u),document.body.appendChild(a),s.display="inline-block",n=Math.ceil(a.getBoundingClientRect().height),o=Math.ceil(a.getBoundingClientRect().width),document.body.removeChild(a),{height:n,width:o}}function measureWidth(t,e){var r=document.createElement("canvas").getContext("2d");return r.font=e,r.measureText(t).width}function sprintf(){if(!arguments)return"";if(1==arguments.length)return arguments[0];var t=arguments[0],e=[/(%\d:s)/,/(%s)/],r=e[0].test(t),n=e[1].test(t),o=0,a=[];for(i=1;i<arguments.length;i++)a.push(arguments[i]);if(r&&n)alert("Неверно задан шаблон строки формата!");else{if(!r&&!n)return t;if(regexpr=r?/(%\d:s)/g:/(%s)/g,r||a.length==t.match(regexpr).length)return t.split(regexpr).map((function(t,e,r){return regexpr.exec(t)?a[/\d/.exec(t)||o++]:t})).join("");alert("Неверное количество аргументов!")}}function getStyle(t,e){var r=document.getElementById(t);if(r){if(r.currentStyle)var n=r.currentStyle[e];else if(window.getComputedStyle)n=document.defaultView.getComputedStyle(r,null).getPropertyValue(e);return n}}function debounce(t,e){var r;return function(){clearTimeout(r),r=setTimeout((function(){t.apply(this,arguments)}),e)}}function throttle(t,e){var r,n,o=!1;return function i(){if(o)return r=arguments,void(n=this);t.apply(this,arguments),o=!0,setTimeout((function(){o=!1,r&&(i.apply(n,r),r=n=null)}),e)}}is=new BrowserCheck;